(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[276],{8854:function(e,r,t){Promise.resolve().then(t.bind(t,1700))},1700:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return d}});var a=t(7437),n=t(2265),i=t(9376),s=t(6281),l=t(9178),o=t(4226),c=t(8395);function d(){var e;let{user:r,loading:t}=(0,s.a)(),d=(0,i.useRouter)(),[u,p]=(0,n.useState)(null),[h,m]=(0,n.useState)({}),[b,g]=(0,n.useState)(0),[f,y]=(0,n.useState)(!1),[x,v]=(0,n.useState)(null);if(t)return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})});if(!r)return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Please sign in to use this feature"}),(0,a.jsx)("a",{href:"/login",className:"text-blue-600 hover:text-blue-700",children:"Sign In"})]})});let N=u?(0,c.Z)(u):null,j=(null==N?void 0:N.wizardQuestions)||[],w=j[b],P=e=>{p(e),m({pack_type:e,payment_method:"finance",has_trade_in:!1}),g(0)},I=(e,r)=>{m(t=>({...t,[e]:r}))},_=async()=>{if(u){y(!0),v(null);try{let e=await fetch("/api/copilot/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...h,pack_type:u})}),r=await e.json();if(!r.success)throw Error(r.error||"Failed to create session");d.push("/copilot/".concat(r.sessionId))}catch(e){v(e.message||"Failed to create session"),y(!1)}}};return u?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-12",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:null==N?void 0:N.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:"".concat((b+1)/j.length*100,"%")}})}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[b+1," / ",j.length]})]})]}),x&&(0,a.jsx)(l.Z,{className:"bg-red-50 border-red-200 mb-6",children:(0,a.jsx)("p",{className:"text-red-700",children:x})}),(0,a.jsx)(l.Z,{className:"mb-6",children:w&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-lg font-semibold text-gray-900 mb-2",children:[w.label,w.required&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),w.helpText&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:w.helpText}),"select"===w.type&&(0,a.jsx)("div",{className:"space-y-3",children:null===(e=w.options)||void 0===e?void 0:e.map((e,r)=>(0,a.jsx)("button",{onClick:()=>I(w.id,e.value),className:"w-full text-left p-4 border-2 rounded-lg transition ".concat(h[w.id]===e.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"),children:e.label},"".concat(w.id,"-").concat(r,"-").concat(String(e.value))))}),"number"===w.type&&(0,a.jsx)("input",{type:"number",value:"number"==typeof h[w.id]?h[w.id]:"",onChange:e=>I(w.id,parseFloat(e.target.value)||0),placeholder:w.placeholder,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),"boolean"===w.type&&(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{onClick:()=>I(w.id,!0),className:"flex-1 p-4 border-2 rounded-lg transition ".concat(!0===h[w.id]?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"),children:"Yes"}),(0,a.jsx)("button",{onClick:()=>I(w.id,!1),className:"flex-1 p-4 border-2 rounded-lg transition ".concat(!1===h[w.id]?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"),children:"No"})]}),"text"===w.type&&(0,a.jsx)("input",{type:"text",value:"string"==typeof h[w.id]?h[w.id]:"",onChange:e=>I(w.id,e.target.value),placeholder:w.placeholder,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),"textarea"===w.type&&(0,a.jsx)("textarea",{value:"string"==typeof h[w.id]?h[w.id]:"",onChange:e=>I(w.id,e.target.value),placeholder:w.placeholder,rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(o.Z,{variant:"secondary",onClick:()=>{b>0?g(b-1):p(null)},disabled:f,children:0===b?"Back to Packs":"Back"}),(0,a.jsx)(o.Z,{onClick:()=>{b<j.length-1?g(b+1):_()},disabled:f||(null==w?void 0:w.required)&&!h[w.id],children:f?"Creating...":b===j.length-1?"Start Negotiation":"Next"})]})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-12",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Start New Negotiation"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Choose a pack that matches your situation"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.values(c.l).map(e=>(0,a.jsxs)("div",{className:"p-6 hover:shadow-lg transition cursor-pointer bg-white rounded-xl shadow-sm border border-slate-200",onClick:()=>P(e.id),children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:e.name}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:e.description}),(0,a.jsx)(o.Z,{className:"w-full",children:"Select Pack"})]},e.id))})]})})}},4226:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var a=t(7437);function n(e){let{variant:r="primary",size:t="md",className:n="",children:i,...s}=e;return(0,a.jsx)("button",{className:"".concat("font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2"," ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500"}[r]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[t]," ").concat(n),...s,children:i})}t(2265)},9178:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var a=t(7437);function n(e){let{children:r,className:t=""}=e;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 ".concat(t),children:r})}t(2265)},6281:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return o},a:function(){return c}});var a=t(7437),n=t(2265);let i=(0,t(9997).B)(),s=()=>{{let e="https://vabikejehdmpfcyqrgrs.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZhYmlrZWplaGRtcGZjeXFyZ3JzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0NzAzNDAsImV4cCI6MjA4MTA0NjM0MH0.X_Z7szu62swGviqYgtI2mxV3F1vX4UBYpuZYV2n7h4Q";return!!(e&&r&&e.length>10&&r.length>10&&!e.includes("placeholder"))}},l=(0,n.createContext)(void 0);function o(e){let{children:r}=e,[t,o]=(0,n.useState)(null),[c,d]=(0,n.useState)(!0);(0,n.useEffect)(()=>{if(!s()){console.warn("Supabase not configured. Running in unauthenticated mode."),o(null),d(!1);return}let e=!0,r=null;(async()=>{try{let{data:{session:t},error:a}=await i.auth.getSession();if(!e)return;if(a)console.error("[AuthContext] Error getting initial session:",a),o(null);else{var r;console.log("[AuthContext] Initial session:",t?"User: ".concat(t.user.email):"No session"),o(null!==(r=null==t?void 0:t.user)&&void 0!==r?r:null)}d(!1)}catch(r){if(!e)return;console.error("[AuthContext] Error initializing auth:",r),o(null),d(!1)}})();let{data:{subscription:t}}=i.auth.onAuthStateChange(async(r,t)=>{var a;e&&(console.log("[AuthContext] Auth state changed:",r,t?"User: ".concat(t.user.email):"No session"),o(null!==(a=null==t?void 0:t.user)&&void 0!==a?a:null),d(!1))});return r=t,()=>{e=!1,r&&r.unsubscribe()}},[]);let u=async()=>{s()&&await i.auth.signOut(),o(null)};return(0,a.jsx)(l.Provider,{value:{user:t,loading:c,signOut:u},children:r})}function c(){let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},8395:function(e,r,t){"use strict";t.d(r,{Z:function(){return n},l:function(){return a}});let a={first_time:{id:"first_time",name:"First-Time Buyer Pack",description:"Guidance for first-time buyers: financing basics, affordability, clarity.",features:["Budget & credit band questions","APR & term definitions","OTD vs monthly education","First-time friendly scripts"],education:["OTD includes taxes, fees, and registration - focus on OTD, not monthly.","APR is the annualized cost of borrowing - compare against pre-approval if you have one.","Longer terms lower monthly payment but increase total interest paid."],questions:[{id:"budget",label:"Max OTD budget",type:"number",required:!0,placeholder:"e.g., 25000"},{id:"credit_band",label:"Credit range (approx)",type:"select",required:!1,options:[{value:"excellent",label:"Excellent (760+)"},{value:"good",label:"Good (700-759)"},{value:"fair",label:"Fair (640-699)"},{value:"new",label:"Limited/First-time"}]},{id:"down_payment_est",label:"Down payment estimate",type:"number",required:!1,placeholder:"e.g., 4000"},{id:"driving_needs",label:"Primary driving needs",type:"text",required:!1,placeholder:"e.g., commute 40 miles daily"}]},cash:{id:"cash",name:"Cash Buyer Pack",description:"Cash-specific tactics and proof-of-funds handling.",features:["Cash disclosure timing","Proof-of-funds guidance","OTD and fees focus","No monthly payment talk"],education:["Delay disclosing cash until you have negotiated price.","Have proof of funds ready, but share only when it helps close at your price.","Cash can justify lower price: simpler deal, no financing reserve for dealer."],questions:[{id:"proof_of_funds",label:"Do you have proof of funds?",type:"boolean",required:!1},{id:"disclose_cash",label:"When do you want to disclose cash?",type:"select",required:!1,options:[{value:"late",label:"Only after price is agreed"},{value:"mid",label:"After initial counter"},{value:"early",label:"I prefer to disclose early"}]},{id:"open_to_finance",label:"Open to financing if it reduces price?",type:"boolean",required:!1}],comingSoon:!0},financing:{id:"financing",name:"Financing Buyer Pack",description:"Financing coaching: APR, term, pre-approval leverage.",features:["Max monthly & OTD focus","Pre-approval leverage","APR/term questions","Payment anchoring avoidance"],education:["Negotiate OTD first, financing second - do not anchor on monthly payment.","Compare dealer APR against your pre-approval; ask if low APR is contingent on add-ons.","Shorter terms cost more monthly but less interest overall."],questions:[{id:"target_monthly",label:"Target monthly (optional)",type:"number",required:!1,placeholder:"e.g., 400"},{id:"max_otd",label:"Max OTD",type:"number",required:!0,placeholder:"e.g., 25000"},{id:"preferred_term",label:"Preferred term",type:"select",required:!1,options:[{value:"36",label:"36 mo"},{value:"48",label:"48 mo"},{value:"60",label:"60 mo"},{value:"72",label:"72 mo"}]},{id:"pre_approved",label:"Do you have pre-approval?",type:"boolean",required:!1},{id:"pre_approval_rate",label:"Pre-approval APR",type:"number",required:!1,placeholder:"e.g., 5.5"}],comingSoon:!0},in_person:{id:"in_person",name:"In-Person Negotiation Pack",description:"Dealership talk tracks and pressure handling.",features:["Short talk tracks","Manager/pressure tactics","If they say X â†’ say Y","Closing script for OTD"],education:["Practice your talk track - don't rely on recording; use written notes instead.",'If "manager" pressure starts, slow down: ask for written OTD before deciding.',"Have 2-3 calm phrases ready for add-on upsells."],questions:[{id:"comfort_firm",label:"Comfort being firm?",type:"select",required:!1,options:[{value:"low",label:"Prefer soft approach"},{value:"medium",label:"Comfortable pushing back politely"},{value:"high",label:"Very firm when needed"}]},{id:"expected_objections",label:"Objections you expect",type:"textarea",required:!1,placeholder:'e.g., "Price is already low", "Manager approval needed".'},{id:"has_trade_in",label:"Trade-in?",type:"boolean",required:!1}]},bundle:{id:"bundle",name:"Complete Bundle",description:"Get both packs at a discounted price: First-Time Buyer Pack + In-Person Negotiation Pack.",features:["Everything in First-Time Buyer Pack","Everything in In-Person Negotiation Pack","Best value for comprehensive coverage","Unlock both packs with one purchase"],education:["The bundle includes all features from both individual packs.","Perfect if you want complete guidance from first contact through in-person negotiation.","Save money compared to buying packs separately."],questions:[]}};function n(e){return a[e]||a.first_time}},9997:function(e,r,t){"use strict";t.d(r,{B:function(){return s}});var a=t(4033);let n="https://vabikejehdmpfcyqrgrs.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZhYmlrZWplaGRtcGZjeXFyZ3JzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0NzAzNDAsImV4cCI6MjA4MTA0NjM0MH0.X_Z7szu62swGviqYgtI2mxV3F1vX4UBYpuZYV2n7h4Q";if(!n||!i){let e=[];throw n||e.push("NEXT_PUBLIC_SUPABASE_URL"),i||e.push("NEXT_PUBLIC_SUPABASE_ANON_KEY"),Error("[CRITICAL] Missing required Supabase environment variables: ".concat(e.join(", "),". ")+"These must be set in Vercel environment variables and available at build time.")}if(n.includes("placeholder")||i.includes("placeholder")){let e=[];throw n.includes("placeholder")&&e.push("NEXT_PUBLIC_SUPABASE_URL"),i.includes("placeholder")&&e.push("NEXT_PUBLIC_SUPABASE_ANON_KEY"),Error("[CRITICAL] Supabase environment variables contain placeholder values. Please set real values in Vercel environment variables. "+"Found placeholder in: ".concat(e.join(" and ")))}if(n.length<10||i.length<10)throw Error("[CRITICAL] Supabase environment variables appear to be invalid (too short). Please verify they are set correctly in Vercel.");function s(){return(0,a.createBrowserClient)(n,i)}},9376:function(e,r,t){"use strict";var a=t(5475);t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[33,971,117,744],function(){return e(e.s=8854)}),_N_E=e.O()}]);