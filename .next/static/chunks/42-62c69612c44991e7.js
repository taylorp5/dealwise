"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[42],{9042:function(e,t,r){r.d(t,{Z:function(){return y}});var a=r(7437),s=r(2265),n=r(9376),l=r(6281),i=r(9997),o=r(4226),c=r(9178),d=r(9205);let u=(0,d.Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),h=(0,d.Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var m=r(2934);let g=(0,d.Z)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),x=(0,i.B)();function y(e){var t;let{mode:r="free"}=e,{user:i}=(0,l.a)();(0,n.useSearchParams)();let[d,y]=(0,s.useState)(""),[p,f]=(0,s.useState)(!1),[b,v]=(0,s.useState)(null),[w,N]=(0,s.useState)(null),[j,I]=(0,s.useState)(null);(0,s.useEffect)(()=>{{let e="deal_plan_".concat(r),t=localStorage.getItem(e);if(t)try{let e=JSON.parse(t);e.listingUrl&&e.analysisResult&&(y(e.listingUrl),v(e.analysisResult))}catch(e){console.error("Failed to load saved deal plan:",e)}}},[r]),(0,s.useEffect)(()=>{if(b&&d){let e="deal_plan_".concat(r);try{localStorage.setItem(e,JSON.stringify({listingUrl:d,analysisResult:b,timestamp:Date.now()}))}catch(e){console.error("Failed to save deal plan:",e)}}},[b,d,r]);let k=async(e,t)=>{try{await navigator.clipboard.writeText(e),I(t),setTimeout(()=>I(null),2e3)}catch(e){console.error("Failed to copy:",e)}},A=async e=>{if(e.preventDefault(),d.trim()){f(!0),N(null);try{let{data:{session:e}}=await x.auth.getSession(),t={"Content-Type":"application/json"};(null==e?void 0:e.access_token)&&(t.Authorization="Bearer ".concat(e.access_token));let a=await fetch("/api/analyze-listing",{method:"POST",headers:t,body:JSON.stringify({listingUrl:d,packVariant:"first-time"===r?"first_time":"in-person"===r?"in_person":"free"})});if(!a.ok){let e=await a.text().catch(()=>"");throw Error("Analysis failed: HTTP ".concat(a.status,". ").concat(e.slice(0,300)))}let s=await a.json();if(!(null==s?void 0:s.success))throw Error((null==s?void 0:s.error)||"Failed to analyze listing");v(s.data||s),f(!1)}catch(e){N(e.message||"Failed to analyze listing"),f(!1)}}},C=(()=>{var e,t;if(!b)return null;let r=b.confidence||(null===(e=b.diagnostics)||void 0===e?void 0:e.confidence),a=b.price||b.askingPrice,s=b.year&&b.make&&b.model,n=b.issues&&b.issues.length>0;return b.blocked||(null===(t=b.diagnostics)||void 0===t?void 0:t.blocked)||!a||!s?{status:"not-ready",icon:u,color:"red",title:"Not Ready â€” Missing Critical Info",message:'We need more information to provide a complete assessment. Please use "Copy from Listing Page" or "Manual Entry" to provide vehicle details.'}:n||void 0!==r&&r<.7?{status:"caution",icon:h,color:"yellow",title:"Proceed with Caution",message:"Some information may be incomplete or unclear. Review the details carefully before proceeding."}:{status:"ready",icon:m.Z,color:"green",title:"Ready to Proceed",message:"You have the key information needed. Review the assessment below before contacting the dealer."}})(),S=(null==C?void 0:C.icon)||m.Z;return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:["first-time"===r?(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Deal Readiness / Confidence Assessment"}),(0,a.jsx)("p",{className:"text-lg text-gray-600",children:"Expert review before you contact the dealer"})]}):(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Listing Analyzer"}),(0,a.jsx)("p",{className:"text-lg text-gray-600",children:"Analyze vehicle listings and get deal insights"})]}),(0,a.jsx)(c.Z,{className:"mb-8 p-6",children:(0,a.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"listing-url",className:"block text-sm font-medium text-gray-700 mb-2",children:"Listing URL"}),(0,a.jsx)("input",{id:"listing-url",type:"url",value:d,onChange:e=>y(e.target.value),placeholder:"Paste vehicle listing URL here...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsx)(o.Z,{type:"submit",disabled:p||!d.trim(),children:p?"Analyzing...":"Analyze Listing"})]})}),w&&(0,a.jsx)(c.Z,{className:"mb-8 p-6 bg-red-50 border-red-200",children:(0,a.jsx)("p",{className:"text-red-800",children:w})}),b&&(0,a.jsxs)("div",{className:"space-y-6",children:["first-time"===r&&C&&(0,a.jsx)(c.Z,{className:"p-6 ".concat("red"===C.color?"bg-red-50 border-red-200":"yellow"===C.color?"bg-yellow-50 border-yellow-200":"bg-green-50 border-green-200"),children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)(S,{className:"w-6 h-6 flex-shrink-0 mt-1 ".concat("red"===C.color?"text-red-600":"yellow"===C.color?"text-yellow-600":"text-green-600")}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-2 ".concat("red"===C.color?"text-red-900":"yellow"===C.color?"text-yellow-900":"text-green-900"),children:C.title}),(0,a.jsx)("p",{className:"red"===C.color?"text-red-800":"yellow"===C.color?"text-yellow-800":"text-green-800",children:C.message})]})]})}),(0,a.jsxs)(c.Z,{className:"p-6",children:["first-time"===r?(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Deal Readiness Assessment"}):(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Deal Plan"}),(0,a.jsxs)("div",{className:"space-y-4",children:[b.price&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Asking Price: "}),(0,a.jsxs)("span",{className:"text-lg font-bold text-gray-900",children:["$",b.price.toLocaleString()]})]}),b.year&&b.make&&b.model&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Vehicle: "}),(0,a.jsxs)("span",{className:"text-lg font-semibold text-gray-900",children:[b.year," ",b.make," ",b.model]})]}),b.otdEstimate&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"Estimated Out-the-Door Price"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-900",children:["$",(null===(t=b.otdEstimate.total)||void 0===t?void 0:t.toLocaleString())||"N/A"]})]})]})]}),"first-time"===r&&(0,a.jsxs)(c.Z,{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"If you proceed, send this (written only)"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Use these professional, beginner-safe messages when contacting the dealer. Copy and paste as needed."}),(0,a.jsx)("div",{className:"space-y-4",children:[{title:"Safe Opener",message:"Hi, I'm interested in this vehicle. Could you please send me a written itemized breakdown of the out-the-door price? I'd like to see the sale price, taxes, doc fee, title/registration fees, and any add-ons all on one sheet. Thank you!"},{title:"Clarify Add-ons",message:"Thank you for the breakdown. Could you clarify which items are optional versus mandatory? If any add-ons are required, I'd like to see the buyer's order or OTD worksheet in writing before we proceed. I want to make sure I understand the total cost clearly."},{title:"Disengage/Pause",message:"Thank you for the information. I'd like to review everything in writing and will follow up once I've had a chance to go through the details. I appreciate your patience."}].map((e,t)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:e.title}),(0,a.jsx)(o.Z,{size:"sm",variant:"secondary",onClick:()=>k(e.message,t),className:"flex items-center gap-2",children:j===t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),"Copied!"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g,{className:"w-4 h-4"}),"Copy"]})})]}),(0,a.jsx)("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:e.message})]},t))})]})]})]})})}},4226:function(e,t,r){r.d(t,{Z:function(){return s}});var a=r(7437);function s(e){let{variant:t="primary",size:r="md",className:s="",children:n,...l}=e;return(0,a.jsx)("button",{className:"".concat("font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2"," ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500"}[t]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[r]," ").concat(s),...l,children:n})}r(2265)},9178:function(e,t,r){r.d(t,{Z:function(){return s}});var a=r(7437);function s(e){let{children:t,className:r=""}=e;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 ".concat(r),children:t})}r(2265)},6281:function(e,t,r){r.d(t,{AuthProvider:function(){return o},a:function(){return c}});var a=r(7437),s=r(2265);let n=(0,r(9997).B)(),l=()=>{{let e="https://vabikejehdmpfcyqrgrs.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZhYmlrZWplaGRtcGZjeXFyZ3JzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0NzAzNDAsImV4cCI6MjA4MTA0NjM0MH0.X_Z7szu62swGviqYgtI2mxV3F1vX4UBYpuZYV2n7h4Q";return!!(e&&t&&e.length>10&&t.length>10&&!e.includes("placeholder"))}},i=(0,s.createContext)(void 0);function o(e){let{children:t}=e,[r,o]=(0,s.useState)(null),[c,d]=(0,s.useState)(!0);(0,s.useEffect)(()=>{if(!l()){console.warn("Supabase not configured. Running in unauthenticated mode."),o(null),d(!1);return}let e=!0,t=null;(async()=>{try{let{data:{session:r},error:a}=await n.auth.getSession();if(!e)return;if(a)console.error("[AuthContext] Error getting initial session:",a),o(null);else{var t;console.log("[AuthContext] Initial session:",r?"User: ".concat(r.user.email):"No session"),o(null!==(t=null==r?void 0:r.user)&&void 0!==t?t:null)}d(!1)}catch(t){if(!e)return;console.error("[AuthContext] Error initializing auth:",t),o(null),d(!1)}})();let{data:{subscription:r}}=n.auth.onAuthStateChange(async(t,r)=>{var a;e&&(console.log("[AuthContext] Auth state changed:",t,r?"User: ".concat(r.user.email):"No session"),o(null!==(a=null==r?void 0:r.user)&&void 0!==a?a:null),d(!1))});return t=r,()=>{e=!1,t&&t.unsubscribe()}},[]);let u=async()=>{l()&&await n.auth.signOut(),o(null)};return(0,a.jsx)(i.Provider,{value:{user:r,loading:c,signOut:u},children:t})}function c(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9997:function(e,t,r){r.d(t,{B:function(){return l}});var a=r(4033);let s="https://vabikejehdmpfcyqrgrs.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZhYmlrZWplaGRtcGZjeXFyZ3JzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0NzAzNDAsImV4cCI6MjA4MTA0NjM0MH0.X_Z7szu62swGviqYgtI2mxV3F1vX4UBYpuZYV2n7h4Q";if(!s||!n){let e=[];throw s||e.push("NEXT_PUBLIC_SUPABASE_URL"),n||e.push("NEXT_PUBLIC_SUPABASE_ANON_KEY"),Error("[CRITICAL] Missing required Supabase environment variables: ".concat(e.join(", "),". ")+"These must be set in Vercel environment variables and available at build time.")}if(s.includes("placeholder")||n.includes("placeholder")){let e=[];throw s.includes("placeholder")&&e.push("NEXT_PUBLIC_SUPABASE_URL"),n.includes("placeholder")&&e.push("NEXT_PUBLIC_SUPABASE_ANON_KEY"),Error("[CRITICAL] Supabase environment variables contain placeholder values. Please set real values in Vercel environment variables. "+"Found placeholder in: ".concat(e.join(" and ")))}if(s.length<10||n.length<10)throw Error("[CRITICAL] Supabase environment variables appear to be invalid (too short). Please verify they are set correctly in Vercel.");function l(){return(0,a.createBrowserClient)(s,n)}},9205:function(e,t,r){r.d(t,{Z:function(){return u}});var a=r(2265);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),l=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:d="",children:u,iconNode:h,...m}=e;return(0,a.createElement)("svg",{ref:t,...c,width:s,height:s,stroke:r,strokeWidth:l?24*Number(n)/Number(s):n,className:i("lucide",d),...!u&&!o(m)&&{"aria-hidden":"true"},...m},[...h.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let r=(0,a.forwardRef)((r,n)=>{let{className:o,...c}=r;return(0,a.createElement)(d,{ref:n,iconNode:t,className:i("lucide-".concat(s(l(e))),"lucide-".concat(e),o),...c})});return r.displayName=l(e),r}},2934:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},9376:function(e,t,r){var a=r(5475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})}}]);