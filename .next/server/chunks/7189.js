"use strict";exports.id=7189,exports.ids=[7189],exports.modules={47189:(e,t,s)=>{s.d(t,{Z:()=>m});var a=s(10326),r=s(17577),l=s(35047),i=s(21021),n=s(3679),o=s(33136),d=s(57166),c=s(64777);function m({initialVariant:e="free"}={}){let t=(0,l.useRouter)(),{user:s,loading:m}=(0,o.a)(),{hasFirstTime:x,hasInPerson:u,loading:g,entitlements:b}=(0,c.m)(),[h]=(0,r.useState)(e),p="first_time"===h,y="in_person"===h,[f,j]=(0,r.useState)("basics"),[N,v]=(0,r.useState)(""),[w,C]=(0,r.useState)(""),[k,S]=(0,r.useState)(""),[D,A]=(0,r.useState)("used"),[F,T]=(0,r.useState)("dealer"),[O,R]=(0,r.useState)(""),[$,M]=(0,r.useState)(!1),[I,L]=(0,r.useState)(null),[Z,E]=(0,r.useState)(!1),[P,_]=(0,r.useState)(null),[V,W]=(0,r.useState)(""),[Y,z]=(0,r.useState)(""),[H,B]=(0,r.useState)(""),[K,U]=(0,r.useState)(""),[G,q]=(0,r.useState)([]),[X,J]=(0,r.useState)(""),[Q,ee]=(0,r.useState)(""),[et,es]=(0,r.useState)(""),[ea,er]=(0,r.useState)([]),[el,ei]=(0,r.useState)(""),[en,eo]=(0,r.useState)([]),[ed,ec]=(0,r.useState)(0),[em,ex]=(0,r.useState)(0),[eu,eg]=(0,r.useState)(0),[eb,eh]=(0,r.useState)(!1),[ep,ey]=(0,r.useState)(!1),[ef,ej]=(0,r.useState)(""),[eN,ev]=(0,r.useState)(""),[ew,eC]=(0,r.useState)(""),[ek,eS]=(0,r.useState)(""),eD=async()=>{if(!N||!w){alert("Please enter both state and ZIP code");return}E(!0);try{let e=await fetch(`/api/tax-lookup?state=${encodeURIComponent(N)}&zip=${encodeURIComponent(w)}`);if(!e.ok)throw Error(`HTTP ${e.status}`);let t=await e.json();if(t.success&&t.data){let e=t.data;if(void 0!==e.combinedRate)R(e.combinedRate.toString());else if(e.combinedRateRange){let t=(e.combinedRateRange.low+e.combinedRateRange.high)/2;R(t.toString())}else R(e.stateBaseRate.toString());L(e),M(!1)}else throw Error(t.error||"Tax lookup unavailable")}catch(t){console.warn("Tax lookup error:",t);let e=(0,d.R4)(N);null!==e&&(R(e.toString()),L({stateBaseRate:e,combinedRate:e,confidence:"low",source:"state_estimate",provider:"fallback"})),_("Tax lookup unavailable right now. Using state estimate. Please verify tax with dealer/DMV.")}finally{E(!1)}},eA=()=>{if(!X||!Q){alert("Please enter both fee name and amount");return}let e=parseFloat(Q);if(isNaN(e)||e<=0){alert("Please enter a valid amount");return}q([...G,{id:Date.now().toString(),name:X,amount:e,isCustom:!0}]),J(""),ee("")},eF=e=>{q(G.filter(t=>t.id!==e))},eT=e=>{if(!e.trim())return!1;if(e.split(/[\n,]/).filter(e=>e.trim()).length>=2)return!0;let t=e.match(/\$[\d,]+\.?\d*/g);return!!(t&&t.length>=2||e.length>=25&&(e.includes("$")||/\d{3,}/.test(e)))},eO=()=>{let e=parseFloat(k)||0,t=parseFloat(O)||0,s=parseFloat(V)||0,a=parseFloat(Y)||0,r=parseFloat(H)||0,l=parseFloat(K)||0,i=G.reduce((e,t)=>e+t.amount,0),n="free"===h?parseFloat(el)||0:ea.reduce((e,t)=>e+t.price,0);ec(e+e*t/100+(s+a+r)),ex(e+e*t/100+(s+a+r+(l+i+n)*.5)),eg(e+e*t/100+(s+a+r+l+i)+n);let o=[];n>2e3&&o.push("High add-on costs detected. Review each item carefully."),l>500&&o.push("Unusually high dealer fees. Request itemized breakdown."),i>1e3&&o.push("Multiple custom fees detected. Verify each is necessary."),eo(o),j("results")};return m?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8",children:[!1,a.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)(i.Z,{className:"p-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Smart OTD Builder"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Calculate your out-the-door price with all fees, taxes, and add-ons"}),(0,a.jsxs)("div",{className:"flex space-x-2 mb-6 border-b border-gray-200",children:[a.jsx("button",{onClick:()=>j("basics"),className:`px-4 py-2 font-medium ${"basics"===f?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:p?"Step 1: Verify Your Location & Price":"Step 1: Basics"}),a.jsx("button",{onClick:()=>j("fees"),className:`px-4 py-2 font-medium ${"fees"===f?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:p?"Step 2: Common Fees to Expect":"Step 2: Fees"}),a.jsx("button",{onClick:()=>j("addons"),className:`px-4 py-2 font-medium ${"addons"===f?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:p?"Step 3: Identify Optional Add-Ons":"Step 3: Add-on Detector"}),a.jsx("button",{onClick:()=>"results"===f&&j("results"),className:`px-4 py-2 font-medium ${"results"===f?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,disabled:"results"!==f,children:p?"OTD Reality Check":"Your OTD Estimate"})]}),"basics"===f&&(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:p?"Step 1: Verify Your Location & Price":"Step 1: Basics"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vehicle Price (Listed Price)"}),a.jsx("input",{type:"text",value:k,onChange:e=>S(e.target.value),placeholder:"25000",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Registration State"}),(0,a.jsxs)("select",{value:N,onChange:e=>v(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Select state"}),Object.keys(d.X6).map(e=>a.jsx("option",{value:e,children:(0,d.pt)(e)},e))]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Registration ZIP Code (optional, for accurate tax rate)"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("input",{type:"text",value:w,onChange:e=>C(e.target.value),placeholder:"90210",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx(n.Z,{onClick:eD,disabled:Z,children:Z?"Looking up...":"Lookup Tax Rate"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tax Rate (%)",!p&&!$&&a.jsx("button",{type:"button",onClick:()=>M(!0),className:"ml-2 text-xs text-blue-600 hover:text-blue-700",children:"Override"})]}),a.jsx("input",{type:"number",value:O,onChange:e=>R(e.target.value),placeholder:"7.5",step:"0.01",disabled:Z||p,readOnly:p,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"}),I&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["zip_lookup"===I.source?`Looked up: ${I.combinedRate||I.stateBaseRate}%`:`Estimated: ${I.combinedRate||I.stateBaseRate}%`,!p&&' Click "Override" to manually adjust.']}),P&&a.jsx("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsx("p",{className:"text-xs text-blue-800",children:P})}),a.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-xs text-yellow-800",children:[a.jsx("strong",{children:"⚠️ Tax rates are estimates only."})," Vehicle tax rules vary by state and locality. Always verify the actual tax rate with the dealer or your state DMV before finalizing."]})})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(n.Z,{onClick:()=>j("fees"),children:"Continue to Fees"})})]})]}),"fees"===f&&(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:p?"Step 2: Common Fees to Expect":"Step 2: Fees"}),p&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-800 mb-4",children:[a.jsx("strong",{children:"\uD83D\uDCA1 Guardrail:"})," If the dealer hasn't provided a fee in writing, don't assume it applies. Ask for an itemized OTD worksheet."]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Documentation Fee (Doc Fee)"}),a.jsx("input",{type:"text",value:V,onChange:e=>W(e.target.value),placeholder:"500",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title Fee"}),a.jsx("input",{type:"text",value:Y,onChange:e=>z(e.target.value),placeholder:"50",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Registration Fee"}),a.jsx("input",{type:"text",value:H,onChange:e=>B(e.target.value),placeholder:"100",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),!p||ep?(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Other Dealer Fees (optional)"}),a.jsx("input",{type:"text",value:K,onChange:e=>U(e.target.value),placeholder:"0",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}):(0,a.jsxs)("div",{children:[a.jsx(n.Z,{type:"button",variant:"secondary",size:"sm",onClick:()=>ey(!ep),children:ep?"Hide other dealer fees":"Add other dealer fees (optional)"}),ep&&a.jsx("input",{type:"text",value:K,onChange:e=>U(e.target.value),placeholder:"0",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 mt-2"})]}),!p||eb?(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Custom Fees (from dealer worksheet)"}),G.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:[e.name,": $",e.amount.toLocaleString()]}),a.jsx(n.Z,{size:"sm",variant:"secondary",onClick:()=>eF(e.id),children:"Remove"})]},e.id)),(0,a.jsxs)("div",{className:"flex space-x-2 mt-2",children:[a.jsx("input",{type:"text",value:X,onChange:e=>J(e.target.value),placeholder:"Fee name",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("input",{type:"text",value:Q,onChange:e=>ee(e.target.value),placeholder:"Amount",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx(n.Z,{onClick:eA,children:"Add"})]})]}):(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[a.jsx(n.Z,{type:"button",variant:"secondary",size:"sm",onClick:()=>eh(!eb),children:eb?"Hide custom fees":"Add fees from dealer worksheet (optional)"}),eb&&(0,a.jsxs)("div",{className:"mt-2",children:[G.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:[e.name,": $",e.amount.toLocaleString()]}),a.jsx(n.Z,{size:"sm",variant:"secondary",onClick:()=>eF(e.id),children:"Remove"})]},e.id)),(0,a.jsxs)("div",{className:"flex space-x-2 mt-2",children:[a.jsx("input",{type:"text",value:X,onChange:e=>J(e.target.value),placeholder:"Fee name",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("input",{type:"text",value:Q,onChange:e=>ee(e.target.value),placeholder:"Amount",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx(n.Z,{onClick:eA,children:"Add"})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx(n.Z,{variant:"secondary",onClick:()=>j("basics"),children:"Back"}),a.jsx(n.Z,{onClick:()=>j("addons"),children:"Continue to Add-ons"})]})]})]}),"addons"===f&&a.jsx("div",{children:"free"===h?(0,a.jsxs)(a.Fragment,{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Step 3: Add-ons (Optional)"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add-ons Total"}),a.jsx("input",{type:"number",value:el,onChange:e=>ei(e.target.value),placeholder:"0",step:"0.01",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the total cost of add-ons from the dealer worksheet. The free version does not auto-detect individual add-ons."})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx(n.Z,{variant:"secondary",onClick:()=>j("fees"),children:"Back"}),a.jsx(n.Z,{onClick:eO,children:"Calculate OTD"})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:p?"Step 3: Identify Optional Add-Ons":"Step 3: Add-on Detector"}),p&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-800 mb-4",children:[a.jsx("strong",{children:"\uD83D\uDCA1 Guardrail:"})," Most add-ons are optional. Paste the worksheet line items to identify what can be removed before agreeing to OTD."]}),(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Format your add-ons using a new line or commas."}),a.jsx("p",{className:"text-xs text-gray-700 mb-2",children:"Example:"}),(0,a.jsxs)("div",{className:"bg-white border border-gray-300 rounded p-2 text-xs font-mono text-gray-800 mb-2",children:["Nitrogen $299",a.jsx("br",{}),"Paint protection $899"]}),a.jsx("p",{className:"text-xs text-gray-600",children:"—or—"}),a.jsx("div",{className:"bg-white border border-gray-300 rounded p-2 text-xs font-mono text-gray-800 mt-2",children:"Nitrogen $299, Paint protection $899"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Paste add-ons from dealer worksheet"}),a.jsx("textarea",{value:et,onChange:e=>es(e.target.value),placeholder:"Extended Warranty - $2,500 GAP Insurance: $500 Paint Protection $300",rows:6,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),!eT(et)&&et.trim()&&a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Add at least one full line item with a price (e.g., 'Nitrogen $299')."})]}),a.jsx("div",{children:a.jsx(n.Z,{onClick:()=>{if(!et.trim()){er([]);return}let e=et.split(/[\n,]/).filter(e=>e.trim()),t=[];for(let s of e){let e=s.match(/[\$]?([\d,]+\.?\d*)/),a=e?parseFloat(e[1].replace(/,/g,"")):0,r=s.replace(/[\$][\d,]+\.?\d*/g,"").replace(/[:-]\s*$/,"").trim();if(r&&a>0){let e="normal",s=r.toLowerCase();(s.includes("warranty")||s.includes("protection")||s.includes("coating"))&&(e="maybe"),(s.includes("etch")||s.includes("fabric")||s.includes("paint")||s.includes("rust"))&&(e="inflated"),a>2e3&&(e="inflated"),t.push({name:r,price:a,classification:e})}}er(t)},disabled:!eT(et),className:"w-full",children:"Classify Add-ons"})}),ea.length>0&&(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Detected Add-ons:"}),a.jsx("div",{className:"space-y-2",children:ea.map((e,t)=>(0,a.jsxs)("div",{className:`p-3 rounded-lg border ${"inflated"===e.classification?"bg-red-50 border-red-200":"maybe"===e.classification?"bg-yellow-50 border-yellow-200":"bg-gray-50 border-gray-200"}`,children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["$",e.price.toLocaleString()]})]}),(0,a.jsxs)("div",{children:["inflated"===e.classification&&a.jsx("span",{className:"text-xs font-medium text-red-700 bg-red-100 px-2 py-1 rounded",children:"⚠️ Likely inflated"}),"maybe"===e.classification&&a.jsx("span",{className:"text-xs font-medium text-yellow-700 bg-yellow-100 px-2 py-1 rounded",children:"⚠️ Review carefully"}),"normal"===e.classification&&a.jsx("span",{className:"text-xs font-medium text-gray-700 bg-gray-100 px-2 py-1 rounded",children:"✓ Normal"})]})]}),"inflated"===e.classification&&y&&a.jsx("p",{className:"text-xs text-red-700 mt-2",children:"Consider negotiating removal or significant reduction."})]},t))})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx(n.Z,{variant:"secondary",onClick:()=>j("fees"),children:"Back"}),a.jsx(n.Z,{onClick:eO,children:"Calculate OTD"})]})]})]})}),"results"===f&&(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:p?"OTD Reality Check":"Your OTD Estimate"}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"OTD Price Range"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Low Estimate"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["$",ed.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Expected"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:["$",em.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"High Estimate"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["$",eu.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),p&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6",children:[(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dealer-Quoted OTD (optional)"}),a.jsx("input",{type:"number",value:ek,onChange:e=>eS(e.target.value),placeholder:"0",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Paste the OTD the dealer sent you (from email or worksheet)."})]}),ek&&parseFloat(ek)>0&&(()=>{let e=parseFloat(ek),t=null;return t=e<=eu?{icon:"✅",color:"green",title:"Within expected range",nextStep:"Confirm everything in writing before agreeing."}:e>eu&&e<=1.05*eu?{icon:"⚠️",color:"yellow",title:"Slightly high — ask for itemized breakdown",nextStep:"Request a written itemized OTD breakdown and clarify optional add-ons."}:{icon:"❌",color:"red",title:"Inflated — add-ons/fees likely",nextStep:"Request a written itemized OTD breakdown and clarify optional add-ons."},(0,a.jsxs)("div",{className:`bg-white border-2 rounded-lg p-4 ${"green"===t.color?"border-green-300":"yellow"===t.color?"border-yellow-300":"border-red-300"}`,children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-xl",children:t.icon}),a.jsx("h4",{className:`font-semibold ${"green"===t.color?"text-green-900":"yellow"===t.color?"text-yellow-900":"text-red-900"}`,children:t.title})]}),a.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:[a.jsx("strong",{children:"Next step:"})," ",t.nextStep]})})]})})()]}),y&&(0,a.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-6 mb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Dealer vs Target"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dealer Current OTD"}),a.jsx("input",{type:"number",value:ef,onChange:e=>ej(e.target.value),placeholder:"0",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Target OTD"}),a.jsx("input",{type:"number",value:eN,onChange:e=>ev(e.target.value),placeholder:"0",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Walk-Away Ceiling"}),a.jsx("input",{type:"number",value:ew,onChange:e=>eC(e.target.value),placeholder:"0",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500"})]})]}),a.jsx("div",{className:"bg-white border border-orange-300 rounded-lg p-4 mb-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Gap to Target:"}),a.jsx("span",{className:"ml-2 font-semibold text-gray-900",children:ef&&eN?(()=>{let e=parseFloat(ef)-parseFloat(eN);return e>=0?`+$${e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:`-$${Math.abs(e).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`})():"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Gap to Ceiling:"}),a.jsx("span",{className:"ml-2 font-semibold text-gray-900",children:ef&&ew?(()=>{let e=parseFloat(ef)-parseFloat(ew);return e>=0?`+$${e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:`-$${Math.abs(e).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`})():"—"})]})]})}),ef&&eN&&a.jsx("div",{className:"bg-white border border-orange-300 rounded-lg p-3 mb-4",children:a.jsx("p",{className:"text-sm text-gray-700",children:parseFloat(ef)-parseFloat(eN)>0?"You're above target. Don't agree until OTD is at or below your number.":"You're at/under target. Confirm the written OTD breakdown before signing."})}),a.jsx(n.Z,{type:"button",variant:"secondary",onClick:()=>t.push("/copilot/in-person/live"),className:"w-full",children:"Open Deal Decision Advisor"})]}),en.length>0&&(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[a.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:"⚠️ Warnings"}),a.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-yellow-800",children:en.map((e,t)=>a.jsx("li",{children:e},t))})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx(n.Z,{variant:"secondary",onClick:()=>j("addons"),children:"Back"}),a.jsx(n.Z,{onClick:()=>j("basics"),children:"Start Over"})]})]})]})})]})}},21021:(e,t,s)=>{s.d(t,{Z:()=>r});var a=s(10326);function r({children:e,className:t=""}){return a.jsx("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 ${t}`,children:e})}s(17577)},64777:(e,t,s)=>{s.d(t,{m:()=>l});var a=s(17577);let r=(0,s(8903).B)();function l(){let[e,t]=(0,a.useState)(!0),[s,l]=(0,a.useState)({first_time:!1,in_person:!1,bundle:!1}),i=(0,a.useCallback)(async()=>{try{t(!0);let{data:{user:e}}=await r.auth.getUser();if(!e){l({first_time:!1,in_person:!1,bundle:!1}),t(!1);return}let{data:s,error:a}=await r.from("user_entitlements").select("first_time, in_person, bundle").eq("user_id",e.id).single();a?"PGRST116"===a.code?l({first_time:!1,in_person:!1,bundle:!1}):console.error("[useEntitlements] Error fetching entitlements:",a):l({first_time:s?.first_time||!1,in_person:s?.in_person||!1,bundle:s?.bundle||!1})}catch(e){console.error("[useEntitlements] Error:",e)}finally{t(!1)}},[]),n=s.first_time||s.bundle,o=s.in_person||s.bundle,d=s.bundle;return{loading:e,entitlements:s,hasFirstTime:n,hasInPerson:o,hasBundle:d,refreshEntitlements:i}}},57166:(e,t,s)=>{s.d(t,{R4:()=>r,X6:()=>a,pt:()=>l});let a={AL:2,AK:0,AZ:5.6,AR:6.5,CA:7.25,CO:2.9,CT:6.35,DE:0,FL:6,GA:4,HI:4.17,ID:6,IL:6.25,IN:7,IA:6,KS:6.5,KY:6,LA:4.45,ME:5.5,MD:6,MA:6.25,MI:6,MN:6.875,MS:5,MO:4.225,MT:0,NE:5.5,NV:6.85,NH:0,NJ:6.625,NM:5.125,NY:4,NC:4.75,ND:5,OH:5.75,OK:4.5,OR:0,PA:6,RI:7,SC:6,SD:4.5,TN:7,TX:6.25,UT:4.85,VT:6,VA:4.3,WA:6.5,WV:6,WI:5,WY:4,DC:6};function r(e){return a[e.toUpperCase().trim()]??null}function l(e){return({AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming",DC:"District of Columbia"})[e.toUpperCase()]||e}}};