"use strict";(()=>{var e={};e.id=8372,e.ids=[8372],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},98982:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>m,requestAsyncStorage:()=>p,routeModule:()=>u,serverHooks:()=>I,staticGenerationAsyncStorage:()=>d});var s={};t.r(s),t.d(s,{POST:()=>l});var a=t(49303),i=t(88716),n=t(60670),o=t(87070),c=t(19692);async function l(e){try{let r=e.headers.get("authorization"),s=await (0,c.f)(),a=null;if(r?.startsWith("Bearer ")){let e=r.replace("Bearer ",""),{data:{user:i},error:n}=await s.auth.getUser(e);if(n||!i)return o.NextResponse.json({success:!1,error:"Invalid token"},{status:401});a=i.id;let{createClient:c}=await Promise.resolve().then(t.bind(t,37857)),l="https://vabikejehdmpfcyqrgrs.supabase.co",u=process.env.SUPABASE_SERVICE_ROLE_KEY;u?s=c(l,u,{auth:{persistSession:!1,autoRefreshToken:!1}}):(s=c(l,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZhYmlrZWplaGRtcGZjeXFyZ3JzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0NzAzNDAsImV4cCI6MjA4MTA0NjM0MH0.X_Z7szu62swGviqYgtI2mxV3F1vX4UBYpuZYV2n7h4Q",{global:{headers:{Authorization:`Bearer ${e}`}},auth:{persistSession:!1}}),console.warn("SUPABASE_SERVICE_ROLE_KEY not set - RLS may block this operation. Set it in .env.local for server-side operations."))}else{let{data:{session:e}}=await s.auth.getSession();e?.user&&(a=e.user.id)}if(!a)return o.NextResponse.json({success:!1,error:"Unauthorized"},{status:401});let{packId:i}=await e.json();if(!i)return o.NextResponse.json({success:!1,error:"Missing packId"},{status:400});let{data:n,error:l}=await s.from("packs").select("id").eq("id",i).single();if(l||!n)return o.NextResponse.json({success:!1,error:"Pack not found"},{status:404});let{data:u,error:p}=await s.from("user_packs").select("id").eq("user_id",a).eq("pack_id",i).single();if(p&&"PGRST116"!==p.code)throw p;if(u){let{error:e}=await s.from("user_packs").update({is_unlocked:!0,unlocked_at:new Date().toISOString()}).eq("user_id",a).eq("pack_id",i);if(e)throw e}else{let{error:e}=await s.from("user_packs").insert({user_id:a,pack_id:i,is_unlocked:!0,unlocked_at:new Date().toISOString()});if(e)throw e}return o.NextResponse.json({success:!0,packId:i})}catch(e){return console.error("Error unlocking pack:",e),o.NextResponse.json({success:!1,error:e.message||"Failed to unlock pack"},{status:500})}}let u=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/packs/unlock/route",pathname:"/api/packs/unlock",filename:"route",bundlePath:"app/api/packs/unlock/route"},resolvedPagePath:"C:\\dev\\Dealership Copilot\\app\\api\\packs\\unlock\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:I}=u,h="/api/packs/unlock/route";function m(){return(0,n.patchFetch)({serverHooks:I,staticGenerationAsyncStorage:d})}},19692:(e,r,t)=>{t.d(r,{$:()=>o,f:()=>c});var s=t(67721),a=t(71615);let i="https://vabikejehdmpfcyqrgrs.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZhYmlrZWplaGRtcGZjeXFyZ3JzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0NzAzNDAsImV4cCI6MjA4MTA0NjM0MH0.X_Z7szu62swGviqYgtI2mxV3F1vX4UBYpuZYV2n7h4Q";if(!i||!n){let e=[];throw i||e.push("NEXT_PUBLIC_SUPABASE_URL"),n||e.push("NEXT_PUBLIC_SUPABASE_ANON_KEY"),Error(`[CRITICAL] Missing required Supabase environment variables: ${e.join(", ")}. These must be set in Vercel environment variables.`)}if(i.includes("placeholder")||n.includes("placeholder"))throw Error("[CRITICAL] Supabase environment variables contain placeholder values. Please set real values in Vercel environment variables.");if(i.length<10||n.length<10)throw Error("[CRITICAL] Supabase environment variables appear to be invalid (too short). Please verify they are set correctly in Vercel.");function o(){let e=(0,a.cookies)();return(0,s.createServerClient)("https://vabikejehdmpfcyqrgrs.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZhYmlrZWplaGRtcGZjeXFyZ3JzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0NzAzNDAsImV4cCI6MjA4MTA0NjM0MH0.X_Z7szu62swGviqYgtI2mxV3F1vX4UBYpuZYV2n7h4Q",{cookies:{getAll:()=>e.getAll(),setAll(r){try{r.forEach(({name:r,value:t,options:s})=>{e.set(r,t,s)})}catch(e){}}}})}let c=o}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[8948,5972,7857,9702],()=>t(98982));module.exports=s})();