"use strict";(()=>{var e={};e.id=5471,e.ids=[5471],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},73625:(e,a,t)=>{t.r(a),t.d(a,{originalPathname:()=>f,patchFetch:()=>A,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var r={};t.r(r),t.d(r,{GET:()=>c,dynamic:()=>u});var o=t(49303),i=t(88716),n=t(60670),s=t(87070),l=t(74918);let u="force-dynamic";async function c(e){try{let a=e.nextUrl.searchParams,t=a.get("state"),r=a.get("zip");if(!t)return s.NextResponse.json({success:!1,error:"State is required"},{status:400});let o=await (0,l.A)(t,r||void 0);return s.NextResponse.json({success:!0,data:o})}catch(e){return console.error("Tax lookup error:",e),s.NextResponse.json({success:!1,error:e?.message||"Failed to lookup tax rate"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/tax-lookup/route",pathname:"/api/tax-lookup",filename:"route",bundlePath:"app/api/tax-lookup/route"},resolvedPagePath:"C:\\dev\\Dealership Copilot\\app\\api\\tax-lookup\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:h,serverHooks:m}=d,f="/api/tax-lookup/route";function A(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},74918:(e,a,t)=>{t.d(a,{A:()=>s});var r=t(93950);async function o(e){let a=process.env.TAXJAR_API_KEY;if(!a)return null;try{let t=await fetch(`https://api.taxjar.com/v2/rates/${e}`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!t.ok)return null;let r=await t.json();return r.rate?.combined_rate?100*parseFloat(r.rate.combined_rate):null}catch(e){return console.warn("TaxJar lookup failed:",e),null}}async function i(e,a){let t=process.env.AVALARA_ACCOUNT_ID,r=process.env.AVALARA_LICENSE_KEY;if(!t||!r)return null;try{let a=`${t}:${r}`,o="undefined"!=typeof Buffer?Buffer.from(a).toString("base64"):btoa(a),i=await fetch(`https://rest.avatax.com/api/v2/taxrates/bypostalcode?country=US&postalCode=${e}`,{headers:{Authorization:`Basic ${o}`,"Content-Type":"application/json"}});if(!i.ok)return null;let n=await i.json();return n.totalRate?100*parseFloat(n.totalRate):null}catch(e){return console.warn("Avalara lookup failed:",e),null}}function n(e){let a=e.toUpperCase().trim();return["CA","NY","IL","TX","FL","PA"].includes(a)?{low:.5,high:2.5}:["CO","MO","OH","MI","NC","GA"].includes(a)?{low:.25,high:1.5}:{low:0,high:1}}async function s(e,a){let t=e.toUpperCase().trim(),s=(0,r.getTaxRateForState)(t);if(!s&&0!==s)return{stateBaseRate:0,combinedRateRange:{low:0,high:0},confidence:"low",source:"state_estimate",provider:"fallback",disclaimer:"State not found in tax rate table. Please verify tax rate manually."};if(a){let e=a.replace(/[^0-9]/g,"").slice(0,5),r=await o(e);if(null!==r){let e=r-s;return{stateBaseRate:s,estimatedLocalAddOn:e>0?e:0,combinedRate:r,confidence:"high",source:"zip_lookup",provider:"taxjar",disclaimer:"Rate based on ZIP code lookup. Vehicle tax rules vary by state and may differ from general sales tax. Verify with dealer itemization."}}let l=await i(e,t);if(null!==l){let e=l-s;return{stateBaseRate:s,estimatedLocalAddOn:e>0?e:0,combinedRate:l,confidence:"high",source:"zip_lookup",provider:"avalara",disclaimer:"Rate based on ZIP code lookup. Vehicle tax rules vary by state and may differ from general sales tax. Verify with dealer itemization."}}let u=n(t),c=s+u.low,d=s+u.high;return{stateBaseRate:s,estimatedLocalAddOn:(u.low+u.high)/2,combinedRateRange:{low:c,high:d},confidence:"medium",source:"state_table",provider:"fallback",disclaimer:"ZIP lookup unavailable. Using state base rate + estimated local range. Vehicle tax rules vary by state and may differ from general sales tax. Verify with dealer itemization."}}let l=n(t),u=s+l.low,c=s+l.high;return{stateBaseRate:s,estimatedLocalAddOn:(l.low+l.high)/2,combinedRateRange:{low:u,high:c},confidence:"low",source:"state_estimate",provider:"fallback",disclaimer:"ZIP code not provided. Using state base rate + estimated local range. For accurate rates, provide ZIP code. Vehicle tax rules vary by state and may differ from general sales tax. Verify with dealer itemization."}}},93950:(e,a,t)=>{t.r(a),t.d(a,{formatStateName:()=>i,getTaxRateForState:()=>o,stateTaxRates:()=>r});let r={AL:2,AK:0,AZ:5.6,AR:6.5,CA:7.25,CO:2.9,CT:6.35,DE:0,FL:6,GA:4,HI:4.17,ID:6,IL:6.25,IN:7,IA:6,KS:6.5,KY:6,LA:4.45,ME:5.5,MD:6,MA:6.25,MI:6,MN:6.875,MS:5,MO:4.225,MT:0,NE:5.5,NV:6.85,NH:0,NJ:6.625,NM:5.125,NY:4,NC:4.75,ND:5,OH:5.75,OK:4.5,OR:0,PA:6,RI:7,SC:6,SD:4.5,TN:7,TX:6.25,UT:4.85,VT:6,VA:4.3,WA:6.5,WV:6,WI:5,WY:4,DC:6};function o(e){return r[e.toUpperCase().trim()]??null}function i(e){return({AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming",DC:"District of Columbia"})[e.toUpperCase()]||e}}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[8948,5972],()=>t(73625));module.exports=r})();