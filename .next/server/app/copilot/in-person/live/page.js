(()=>{var e={};e.id=1884,e.ids=[1884],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6229:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.Z,__next_app__:()=>x,originalPathname:()=>c,pages:()=>o,routeModule:()=>m,tree:()=>d}),t(89282),t(46855),t(26083),t(35866);var a=t(23191),r=t(88716),l=t(48001),i=t(95231),n={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);t.d(s,n);let d=["",{children:["copilot",{children:["in-person",{children:["live",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,89282)),"C:\\dev\\Dealership Copilot\\app\\copilot\\in-person\\live\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,46855)),"C:\\dev\\Dealership Copilot\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,26083)),"C:\\dev\\Dealership Copilot\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\dev\\Dealership Copilot\\app\\copilot\\in-person\\live\\page.tsx"],c="/copilot/in-person/live/page",x={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/copilot/in-person/live/page",pathname:"/copilot/in-person/live",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9368:(e,s,t)=>{Promise.resolve().then(t.bind(t,55347))},55347:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m});var a=t(10326),r=t(17577),l=t(35047),i=t(33136),n=t(64777),d=t(21021),o=t(3679);function c({dealerOTD:e,targetOTD:s,walkAwayOTD:t,onDealerOTDChange:r,onUpdate:l,disabled:i=!1}){let n=e?e-s:null,c=n&&s>0?(n/s*100).toFixed(1):null;return(0,a.jsxs)(d.Z,{className:"mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Update Deal State"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dealer Current OTD"}),a.jsx("input",{type:"number",value:e||"",onChange:e=>{let s=""===e.target.value?null:parseFloat(e.target.value);r(isNaN(s)?null:s)},placeholder:"Enter dealer's current OTD",disabled:i,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-1",children:"Your Target OTD"}),(0,a.jsxs)("div",{className:"px-3 py-2 bg-gray-50 border border-gray-300 rounded-lg text-sm font-bold text-gray-900",children:["$",s.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-1",children:"Gap"}),(0,a.jsxs)("div",{className:`px-3 py-2 border rounded-lg text-sm font-bold ${null===n?"text-gray-400 border-gray-300 bg-gray-50":n<=0?"text-green-600 border-green-300 bg-green-50":n<=500?"text-yellow-600 border-yellow-300 bg-yellow-50":"text-red-600 border-red-300 bg-red-50"}`,children:[null===n?"—":n>=0?`+$${Math.abs(n).toLocaleString()}`:`-$${Math.abs(n).toLocaleString()}`,c&&null!==n&&n>0&&(0,a.jsxs)("span",{className:"text-xs ml-1",children:["(",c,"%)"]})]})]})]}),a.jsx(o.Z,{onClick:l,disabled:i||null===e,className:"w-full",children:"Update Deal State"})]})]})}let x=(0,t(8903).B)();function m(){let{user:e,loading:s}=(0,i.a)(),t=(0,l.useRouter)(),{loading:m,hasInPerson:h}=(0,n.m)(),[p,u]=(0,r.useState)(""),[g,b]=(0,r.useState)(""),[f,y]=(0,r.useState)(""),[j,N]=(0,r.useState)(""),[v,w]=(0,r.useState)(""),[D,_]=(0,r.useState)(""),[k,C]=(0,r.useState)(!1),[S,P]=(0,r.useState)(null),[T,E]=(0,r.useState)(null),[Z,O]=(0,r.useState)(null),$=async()=>{if(!D.trim()){E("Please describe what just happened");return}C(!0),E(null),P(null);try{let{data:{session:e}}=await x.auth.getSession(),s={"Content-Type":"application/json"};e?.access_token&&(s.Authorization=`Bearer ${e.access_token}`);let t=parseFloat(g)||0,a=parseFloat(f)||(t>0?t+1e3:0),r=parseFloat(p)||0,l={mode:"between_rounds_advisor",userInput:D.trim(),context:{vehiclePrice:r,targetOTD:t,walkAwayOTD:a,dealerOTD:Z||void 0,state:j.trim().toUpperCase()||void 0}},i=await fetch("/api/copilot/in-person/advisor",{method:"POST",headers:s,body:JSON.stringify(l)});if(!i.ok){let e=await i.text();throw Error(`Failed to get advice: ${i.status} ${e}`)}let n=await i.json();if(!n.success)throw Error(n.error||"Failed to get advice");P(n.data)}catch(e){E(e.message||"Failed to get advice")}finally{C(!1)}},A=e=>{navigator.clipboard.writeText(e)};if(s||m)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});if(!e)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"Please sign in to use this feature"}),a.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-700",children:"Sign In"})]})});if(!h)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"In-Person Negotiation Pack required"}),a.jsx("a",{href:"/packs",className:"text-blue-600 hover:text-blue-700",children:"View Packs"})]})});let M=parseFloat(g)||0;return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white border-b border-gray-200",children:a.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:a.jsx(o.Z,{onClick:()=>t.push("/copilot/in-person"),variant:"secondary",size:"sm",children:"← Back to In-Person Pack"})})}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Deal Decision Advisor"}),a.jsx("p",{className:"text-gray-600",children:"Clear next steps after stepping away from the salesperson."})]}),(0,a.jsxs)(d.Z,{className:"mb-8",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Prepare Me"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Set your numbers before you negotiate. The advisor uses these silently to give you better guidance."}),a.jsx(c,{dealerOTD:Z,targetOTD:M,walkAwayOTD:parseFloat(f)||M+1e3,onDealerOTDChange:e=>{O(e)},onUpdate:()=>{},disabled:k})]}),(0,a.jsxs)(d.Z,{className:"mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"What Just Happened?"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Paste what the dealer said or describe the situation. Dollar amounts are optional."}),a.jsx("textarea",{value:D,onChange:e=>_(e.target.value),placeholder:"Example: 'They said the OTD is $28,500 but I need $27,000. They keep asking about monthly payments.'",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary resize-none",rows:5,disabled:k}),a.jsx(o.Z,{onClick:$,disabled:k||!D.trim(),className:"w-full mt-4 text-lg py-6 font-semibold",children:k?(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"animate-spin",children:"⏳"}),"Analyzing situation..."]}):"Get Decision"}),T&&a.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:a.jsx("p",{className:"text-sm text-red-800",children:T})})]}),S&&!k&&(0,a.jsxs)("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-300",children:[a.jsx(d.Z,{className:"bg-blue-50 border-2 border-blue-300",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold text-sm",children:"\uD83D\uDD0D"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-base font-bold text-gray-900 mb-2",children:"Situation Diagnosis"}),a.jsx("p",{className:"text-sm text-gray-800 leading-relaxed font-medium",children:S.whatsReallyHappening})]})]})}),a.jsx(d.Z,{className:"bg-red-50 border-2 border-red-300",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-red-600 rounded-full flex items-center justify-center text-white font-bold text-sm",children:"⚠️"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-base font-bold text-gray-900 mb-2",children:"Why This Matters"}),a.jsx("p",{className:"text-sm text-gray-800 leading-relaxed font-medium",children:S.whyThisMatters})]})]})}),a.jsx(d.Z,{className:"bg-gradient-to-br from-primary/20 to-accent/20 border-2 border-primary/40 shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-primary rounded-full flex items-center justify-center text-white font-bold text-sm",children:"✅"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-base font-bold text-gray-900 mb-2",children:"Correct Move"}),a.jsx("p",{className:"text-base text-gray-900 leading-relaxed font-semibold",children:S.yourBestMove})]})]})}),(0,a.jsxs)(d.Z,{className:"bg-white border-2 border-primary/30 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-primary rounded-full flex items-center justify-center text-white font-bold text-sm",children:"\uD83D\uDDE3️"}),a.jsx("div",{className:"flex-1",children:a.jsx("h3",{className:"text-base font-bold text-gray-900 mb-2",children:"Say This (Exact Script)"})})]}),(0,a.jsxs)("div",{className:"bg-slate-50 border-2 border-slate-300 rounded-lg p-4 ml-11",children:[a.jsx("p",{className:"text-base text-gray-900 leading-relaxed whitespace-pre-wrap font-medium",children:S.exactlyWhatToSay}),a.jsx(o.Z,{onClick:()=>A(S.exactlyWhatToSay),variant:"primary",size:"sm",className:"mt-4",children:"\uD83D\uDCCB Copy Script"})]})]}),a.jsx(d.Z,{className:"bg-green-50 border-2 border-green-300",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-green-600 rounded-full flex items-center justify-center text-white font-bold text-sm",children:"\uD83E\uDDE0"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-base font-bold text-gray-900 mb-2",children:"Confidence Check"}),a.jsx("p",{className:"text-sm text-gray-800 leading-relaxed font-medium italic",children:S.confidenceSignal})]})]})}),(0,a.jsxs)(d.Z,{className:"bg-slate-100 border-2 border-slate-300 mt-6",children:[a.jsx("h3",{className:"text-sm font-bold text-gray-900 mb-3",children:"Why this is different than asking ChatGPT"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-primary mt-0.5",children:"•"}),a.jsx("p",{className:"text-xs text-gray-700",children:"Uses your exact negotiation numbers"})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-primary mt-0.5",children:"•"}),a.jsx("p",{className:"text-xs text-gray-700",children:"Applies dealership-specific tactics"})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-primary mt-0.5",children:"•"}),a.jsx("p",{className:"text-xs text-gray-700",children:"Makes a single clear decision for you"})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-primary mt-0.5",children:"•"}),a.jsx("p",{className:"text-xs text-gray-700",children:"Tells you exactly what to say — no prompt engineering"})]})]})]})]}),a.jsx("div",{className:"mt-8 p-4 bg-slate-50 border border-slate-200 rounded-lg",children:a.jsx("p",{className:"text-xs text-slate-600 italic text-center",children:"\uD83D\uDCA1 This decision advisor is designed for between conversations, not live negotiation. Step away from the salesperson to use it."})})]})]})}},21021:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});var a=t(10326);function r({children:e,className:s=""}){return a.jsx("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 ${s}`,children:e})}t(17577)},64777:(e,s,t)=>{"use strict";t.d(s,{m:()=>l});var a=t(17577);let r=(0,t(8903).B)();function l(){let[e,s]=(0,a.useState)(!0),[t,l]=(0,a.useState)({first_time:!1,in_person:!1,bundle:!1}),i=(0,a.useCallback)(async()=>{try{s(!0);let{data:{user:e}}=await r.auth.getUser();if(!e){l({first_time:!1,in_person:!1,bundle:!1}),s(!1);return}let{data:t,error:a}=await r.from("user_entitlements").select("first_time, in_person, bundle").eq("user_id",e.id).single();a?"PGRST116"===a.code?l({first_time:!1,in_person:!1,bundle:!1}):console.error("[useEntitlements] Error fetching entitlements:",a):l({first_time:t?.first_time||!1,in_person:t?.in_person||!1,bundle:t?.bundle||!1})}catch(e){console.error("[useEntitlements] Error:",e)}finally{s(!1)}},[]),n=t.first_time||t.bundle,d=t.in_person||t.bundle,o=t.bundle;return{loading:e,entitlements:t,hasFirstTime:n,hasInPerson:d,hasBundle:o,refreshEntitlements:i}}},89282:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`C:\dev\Dealership Copilot\app\copilot\in-person\live\page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[8948,3786,2883],()=>t(6229));module.exports=a})();